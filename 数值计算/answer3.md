# 3.1

根据二次拉格朗日插值法，计算步骤如下：
**1. 构造插值多项式：**
给定节点 \( x_0=1, x_1=2, x_2=3 \)，对应函数值 \( y_0=0.368, y_1=0.135, y_2=0.050 \)。二次拉格朗日基函数为：
\[
\begin{aligned}
L_0(x) &= \frac{(x-2)(x-3)}{(1-2)(1-3)} = \frac{(x-2)(x-3)}{2}, \\
L_1(x) &= \frac{(x-1)(x-3)}{(2-1)(2-3)} = -\frac{(x-1)(x-3)}{1}, \\
L_2(x) &= \frac{(x-1)(x-2)}{(3-1)(3-2)} = \frac{(x-1)(x-2)}{2}.
\end{aligned}
\]
插值多项式为：
\[
P(x) = 0.368L_0(x) + 0.135L_1(x) + 0.050L_2(x).
\]
**2. 计算 \( P(2.5) \)：**
代入 \( x=2.5 \) 到各基函数：
\[
\begin{aligned}
L_0(2.5) &= \frac{(2.5-2)(2.5-3)}{2} = -0.125, \\
L_1(2.5) &= -\frac{(2.5-1)(2.5-3)}{1} = 0.75, \\
L_2(2.5) &= \frac{(2.5-1)(2.5-2)}{2} = 0.375.
\end{aligned}
\]
计算近似值：
\[
P(2.5) = 0.368 \times (-0.125) + 0.135 \times 0.75 + 0.050 \times 0.375 = 0.074.
\]
**3. 误差估计：**
误差公式为：
\[
R(x) = \frac{f'''(\xi)}{3!}(x-1)(x-2)(x-3), \quad \xi \in [1,3].
\]
对于 \( f(x) = e^{-x} \)，\( f'''(x) = -e^{-x} \)，故：
\[
|R(2.5)| = \frac{e^{-\xi}}{6} \left| (2.5-1)(2.5-2)(2.5-3) \right| = \frac{e^{-\xi}}{6} \times 0.375 = e^{-\xi} \times 0.0625.
\]
当 \( \xi \in [1,3] \) 时，\( e^{-\xi} \) 的最大值为 \( e^{-1} \approx 0.3679 \)，因此误差上界为：
\[
|R(2.5)| \leq 0.3679 \times 0.0625 \approx 0.023.
\]
**最终答案：**

- \( e^{-2.5} \) 的近似值为 \(\boxed{0.074}\)。
- 误差估计不超过 \(\boxed{0.023}\)。

# 3.2

根据最小二乘法，拟合二次多项式 \( y = a_0 + a_1 x + a_2 x^2 \) 的步骤如下：

1. **计算各阶求和项**：
   \[
   \begin{aligned}
   n &= 6, \\
   \sum x_i &= 15, \\
   \sum x_i^2 &= 55, \\
   \sum x_i^3 &= 225, \\
   \sum x_i^4 &= 979, \\
   \sum y_i &= 14, \\
   \sum x_i y_i &= 30, \\
   \sum x_i^2 y_i &= 122.
   \end{aligned}
   \]
2. **建立正规方程组**：
   \[
   \begin{cases}
   6a_0 + 15a_1 + 55a_2 = 14, \\
   15a_0 + 55a_1 + 225a_2 = 30, \\
   55a_0 + 225a_1 + 979a_2 = 122.
   \end{cases}
   \]
3. **解方程组**：
   - 通过消元法或矩阵运算，解得：
     \[
     a_0 = \frac{33}{7} \approx 4.7143, \quad a_1 = -\frac{39}{14} \approx -2.7857, \quad a_2 = 0.5.
     \]
4. **验证拟合效果**：
   - 代入多项式 \( y = 4.7143 - 2.7857x + 0.5000x^2 \) 计算各 \( x_i \) 处的拟合值，与实际数据吻合较好。
**答案**：
拟合多项式为 \( y = \boxed{4.7143} + \boxed{-2.7857}x + \boxed{0.5000}x^2 \)。

# 3.3

根据Doolittle分解法求解方程组的步骤如下：

1. **矩阵分解**：将系数矩阵 \( A \) 分解为下三角矩阵 \( L \) 和上三角矩阵 \( U \)，其中 \( L \) 的对角线元素为1。分解结果为：
   \[
   L = \begin{bmatrix}
   1 & 0 & 0 \\
   1.5 & 1 & 0 \\
   -\frac{1}{12} & \frac{7}{6} & 1
   \end{bmatrix}, \quad
   U = \begin{bmatrix}
   12 & -3 & 3 \\
   0 & 1.5 & -3.5 \\
   0 & 0 & \frac{16}{3}
   \end{bmatrix}
   \]
2. **前代求解 \( Ly = b \)**：
   \[
   \begin{cases}
   y_1 = 15 \\
   1.5y_1 + y_2 = 15 \implies y_2 = -7.5 \\
   -\frac{1}{12}y_1 + \frac{7}{6}y_2 + y_3 = 6 \implies y_3 = 16
   \end{cases}
   \]
   得到 \( y = \begin{bmatrix} 15 \\ -7.5 \\ 16 \end{bmatrix} \)。
3. **回代求解 \( Ux = y \)**：
   \[
   \begin{cases}
   \frac{16}{3}x_3 = 16 \implies x_3 = 3 \\
   1.5x_2 - 3.5x_3 = -7.5 \implies x_2 = 2 \\
   12x_1 - 3x_2 + 3x_3 = 15 \implies x_1 = 1
   \end{cases}
   \]
**答案**：  
方程组的解为  
\[
\boxed{x_1 = 1}, \quad \boxed{x_2 = 2}, \quad \boxed{x_3 = 3}
\]

# 3.4
### 解答

PFOLG：
+ 带入公式：
   $16*e^4/(180*n^4)<=0.5*10^4$

   ```python
   n=(16*math.exp(4)/(180*.5*1e-4))**(1/4)
   ```
+ 求出n=17.65 → 18

#### (1) 复合 Simpson 公式的等分数计算
对于积分 \(\int_{1}^{2} e^{2x}  dx\)，使用复合 Simpson 公式时，误差估计公式为：
\[
|E_s| \leq \frac{(b-a)}{180} h^4 \max_{\xi \in [a,b]} |f^{(4)}(\xi)|
\]
其中 \(a = 1\)，\(b = 2\)，所以 \(b - a = 1\)；函数 \(f(x) = e^{2x}\)；\(h = \frac{b-a}{n}\)，\(n\) 为子区间数（等分数），且 \(n\) 需为偶数。

计算四阶导数：
- \(f'(x) = 2e^{2x}\)
- \(f''(x) = 4e^{2x}\)
- \(f'''(x) = 8e^{2x}\)
- \(f^{(4)}(x) = 16e^{2x}\)

在区间 \([1, 2]\) 上，\(e^{2x}\) 单调递增，因此 \(\max |f^{(4)}(\xi)| = 16e^{4}\)（在 \(x = 2\) 处取最大值）。代入 \(e^4 \approx 54.598150\)，得：
\[
\max |f^{(4)}(\xi)| = 16 \times 54.598150 = 873.568400
\]

误差公式简化为：
\[
|E_s| \leq \frac{1}{180} h^4 \times 873.568400 = \frac{873.568400}{180} h^4 \approx 4.853153 h^4
\]
其中 \(h = \frac{1}{n}\)，所以：
\[
|E_s| \leq \frac{4.853153}{n^4}
\]

要求误差不超过 \(\frac{1}{2} \times 10^{-4} = 5 \times 10^{-5}\)，即：
\[
\frac{4.853153}{n^4} \leq 5 \times 10^{-5}
\]
解不等式：
\[
n^4 \geq \frac{4.853153}{5 \times 10^{-5}} = \frac{4.853153}{0.00005} = 97063.06
\]
\[
n \geq \sqrt[4]{97063.06} \approx 17.65
\]
由于 \(n\) 必须为整数且偶数（复合 Simpson 公式要求），取 \(n = 18\)。

验证 \(n = 18\)：
- \(n^4 = 18^4 = 104976\)
- \(\frac{4.853153}{104976} \approx 4.622 \times 10^{-5} < 5 \times 10^{-5}\)，满足误差要求。

因此，积分区间至少需要 **18 等分**。

#### (2) 龙贝格算法计算积分
使用龙贝格算法计算 \(\int_{1}^{2} e^{2x}  dx\)，计算到第一个龙贝格值（即 \(R(1,1)\)）。

龙贝格算法基于梯形公式，并进行外推：
- 定义 \(R(0,0)\) 为步长 \(h = b - a = 1\) 的梯形公式结果：
  \[
  R(0,0) = \frac{h}{2} [f(a) + f(b)] = \frac{1}{2} [e^{2 \times 1} + e^{2 \times 2}] = \frac{1}{2} [e^2 + e^4]
  \]
  使用数值 \(e^2 \approx 7.389056099\)，\(e^4 \approx 54.598150033\)：
  \[
  R(0,0) = \frac{1}{2} [7.389056099 + 54.598150033] = \frac{1}{2} \times 61.987206132 = 30.993603066
  \]

- 定义 \(R(1,0)\) 为步长 \(h/2 = 0.5\) 的梯形公式结果（2 个子区间）：
  点：\(x_0 = 1\)，\(x_1 = 1.5\)，\(x_2 = 2\)
  \[
  f(1) = e^2 \approx 7.389056099, \quad f(1.5) = e^{3} \approx 20.085536923, \quad f(2) = e^4 \approx 54.598150033
  \]
  \[
  R(1,0) = \frac{h/2}{2} [f(1) + 2f(1.5) + f(2)] = \frac{0.5}{2} [7.389056099 + 2 \times 20.085536923 + 54.598150033]
  \]
  计算内部和：
  \[
  7.389056099 + 2 \times 20.085536923 + 54.598150033 = 7.389056099 + 40.171073846 + 54.598150033 = 102.158279978
  \]
  \[
  R(1,0) = 0.25 \times 102.158279978 = 25.5395699945
  \]

- 第一个龙贝格值 \(R(1,1)\) 通过外推公式计算：
  \[
  R(1,1) = \frac{4 R(1,0) - R(0,0)}{3} = \frac{4 \times 25.5395699945 - 30.993603066}{3}
  \]
  计算：
  \[
  4 \times 25.5395699945 = 102.158279978
  \]
  \[
  102.158279978 - 30.993603066 = 71.164676912
  \]
  \[
  R(1,1) = \frac{71.164676912}{3} = 23.721558970666\ldots \approx 23.72156
  \]

结果保留 5 位小数，第一个龙贝格值为 **23.72156**。

### 最终答案
(1) 积分区间至少需要 **18** 等分。  
(2) 龙贝格算法计算的第一个龙贝格值为 **23.72156**。
 
## 关于“第一个龙贝格值”的解释

在龙贝格（Romberg）算法中，计算结果按以下三角阵列表格（称为 **T-表**）组织：

|         | \( m=0 \) (梯形) | \( m=1 \) (Simpson)                                            | \( m=2 \) (龙贝格) | ... |
| ------- | ---------------- | -------------------------------------------------------------- | ------------------ | --- |
| **k=0** | \( R(0,0) \)     |                                                                |                    |     |
| **k=1** | \( R(1,0) \)     | **<span style="color:red">\( R(1,1) \)</span>** 第一个龙贝格值 |                    |     |
| **k=2** | \( R(2,0) \)     | \( R(2,1) \)                                                   | \( R(2,2) \)       |     |
| **k=3** | \( R(3,0) \)     | \( R(3,1) \)                                                   | \( R(3,2) \)       | ... |

1. **第一个龙贝格值**：
   - 指的是 **\( R(1,1) \)**，即表中第一行、第一列的外推值。
   - 它由 \( R(0,0) \) 和 \( R(1,0) \) 通过一次外推（使用 Simpson 阶精度）得到：
     \[
     R(1,1) = \frac{4R(1,0) - R(0,0)}{3}
     \]
   - 在题目中，计算结果为 \( 23.72156 \).

2. **后续龙贝格值**：
   - **第二个龙贝格值** 是 \( R(2,2) \)（二阶外推，龙贝格阶精度）：
     \[
     R(2,2) = \frac{16R(2,1) - R(1,1)}{15}
     \]
   - **第三个龙贝格值** 是 \( R(3,3) \)（三阶外推）：
     \[
     R(3,3) = \frac{64R(3,2) - R(2,2)}{63}
     \]
   - 随着外推阶数 \( m \) 增加，精度会进一步提高（每增加一阶，误差阶提高 2 阶）。

### 为什么题目只要求第一个值？
题目明确要求 **“计算到第一个龙贝格值即可”**，即只需完成：
- \( R(0,0) \)（0 次二分的梯形公式）
- \( R(1,0) \)（1 次二分的梯形公式）
- 外推出 \( R(1,1) \).

这是龙贝格算法的**最小完整计算单元**，后续值（如 \( R(2,2) \)）需要更多二分步骤，但本题无需继续。

### 补充说明
- **龙贝格算法的本质**：通过逐步二分区间和反复外推，将低阶积分公式（如梯形）提升为高阶公式（如 Simpson、龙贝格）。
- **收敛性**：随着 \( k \) 和 \( m \) 增加，\( R(k,m) \) 快速收敛到精确积分值（本题精确值为 \( \frac{1}{2}(e^4 - e^2) \approx 23.6045 \)）。

若有进一步计算需求（如求更高阶龙贝格值），可补充说明！


## 公式
在龙贝格（Romberg）算法中，计算过程通过递归公式构建一个三角阵列表格（称为 **T-表**）。以下是各元素的计算公式详解：

---

### **1. 基础公式：梯形公式序列（第 0 列）**
- **\( R(k,0) \)** 表示将区间 \([a, b]\) 进行 \(2^k\) 等分后的**复合梯形公式**结果。
- **通用公式**：
  \[
  R(k,0) = \frac{h_k}{2} \left[ f(a) + 2 \sum_{i=1}^{2^k - 1} f(a + i h_k) + f(b) \right]
  \]
  其中 \( h_k = \dfrac{b - a}{2^k} \) 为步长。

- **递推关系**（更高效的计算方式）：
  \[
  R(k,0) = \frac{1}{2} R(k-1,0) + h_k \sum_{j=1}^{2^{k-1}} f\left(a + (2j-1)h_k\right)
  \]

---

### **2. 外推公式（更高阶列）**
- **\( R(k,m) \)** 表示通过外推得到的更高精度值，其中 \( m \) 为外推阶数。
- **通用外推公式**：
  \[
  R(k,m) = \frac{4^m R(k,m-1) - R(k-1,m-1)}{4^m - 1}
  \]

---

### **3. 本题中要求的元素**
#### **(a) \( R(0,0) \)（0 次二分，步长 \( h_0 = b - a \))**
\[
R(0,0) = \frac{h_0}{2} \left[ f(a) + f(b) \right] \quad \text{其中} \quad h_0 = b - a
\]
- **本题计算**：  
  \( a = 1, \, b = 2, \, h_0 = 1, \, f(x) = e^{2x} \)  
  \[
  R(0,0) = \frac{1}{2} \left[ e^{2 \cdot 1} + e^{2 \cdot 2} \right] = \frac{1}{2} \left[ e^2 + e^4 \right] \approx 30.99360
  \]

#### **(b) \( R(1,0) \)（1 次二分，步长 \( h_1 = \frac{h_0}{2} \))**
\[
R(1,0) = \frac{h_1}{2} \left[ f(a) + 2f(a + h_1) + f(b) \right] \quad \text{其中} \quad h_1 = \frac{b - a}{2}
\]
- **本题计算**：  
  \( h_1 = 0.5, \, \text{分点为} \, x_0 = 1, \, x_1 = 1.5, \, x_2 = 2 \)  
  \[
  R(1,0) = \frac{0.5}{2} \left[ f(1) + 2f(1.5) + f(2) \right] = 0.25 \left[ e^2 + 2e^3 + e^4 \right] \approx 25.53957
  \]

#### **(c) \( R(1,1) \)（第一个龙贝格值）**
\[
R(1,1) = \frac{4^1 R(1,0) - R(0,0)}{4^1 - 1} = \frac{4 \cdot R(1,0) - R(0,0)}{3}
\]
- **本题计算**：  
  \[
  R(1,1) = \frac{4 \times 25.53957 - 30.99360}{3} = \frac{102.15828 - 30.99360}{3} = \frac{71.16468}{3} \approx 23.72156
  \]

---

### **4. 后续龙贝格值（补充说明）**
- **第二个龙贝格值**：\( R(2,2) \)（需先计算 \( R(2,0) \) 和 \( R(2,1) \))  
  \[
  R(2,2) = \frac{4^2 R(2,1) - R(1,1)}{4^2 - 1} = \frac{16 R(2,1) - R(1,1)}{15}
  \]
- **第三个龙贝格值**：\( R(3,3) \)  
  \[
  R(3,3) = \frac{4^3 R(3,2) - R(2,2)}{4^3 - 1} = \frac{64 R(3,2) - R(2,2)}{63}
  \]

---

### **公式总结表**
| **元素**     | **计算公式**                                                                  | **含义**                |
| ------------ | ----------------------------------------------------------------------------- | ----------------------- |
| \( R(0,0) \) | \(\dfrac{h_0}{2} \left[ f(a) + f(b) \right]\)                                 | 不分区的梯形公式        |
| \( R(k,0) \) | \(\dfrac{h_k}{2} \left[ f(a) + 2 \sum_{i=1}^{2^k - 1} f(x_i) + f(b) \right]\) | 二分 \(k\) 次的梯形公式 |
| \( R(k,m) \) | \(\dfrac{4^m R(k,m-1) - R(k-1,m-1)}{4^m - 1}\)                                | Richardson 外推公式     |

---

[龙贝格求积算法中的外推序列](龙贝格求积算法中的外推序列.md)

# 3.5

(1) **求g(x)的另外两个不动点：**
不动点满足方程 \( g(x) = x \)，即：
\[
x^3 - x^2 - 4x + 5 = x \implies x^3 - x^2 - 5x + 5 = 0.
\]
已知 \( x = 1 \) 是根，将多项式分解：
\[
(x - 1)(x^2 - 5) = 0 \implies x = \sqrt{5}, \, x = -\sqrt{5}.
\]
因此，另外两个不动点为 \(\boxed{\sqrt{5}}\) 和 \(\boxed{-\sqrt{5}}\)。
(2) **判断局部收敛性：**
不动点迭代法的收敛性由 \( |g'(x^*)| \) 决定。计算导数：
\[
g'(x) = 3x^2 - 2x - 4.
\]
在 \( x = 1 \) 处：
\[
g'(1) = 3(1)^2 - 2(1) - 4 = -3 \implies |g'(1)| = 3 > 1.
\]
因此，在 \( x_0 = 1 \) 处，不动点迭代法**不局部收敛**，结论为 \(\boxed{\text{不收敛}}\)。
(3) **迭代三次结果及比较：**
取 \( x_0 = 0.8 \)，迭代公式为 \( x_{n+1} = g(x_n) \)。
- **第一次迭代：**
  \[
  x_1 = g(0.8) = 0.8^3 - 0.8^2 - 4(0.8) + 5 = 1.672.
  \]
- **第二次迭代：**
  \[
  x_2 = g(1.672) \approx 1.672^3 - 1.672^2 - 4(1.672) + 5 \approx 0.1906.
  \]
- **第三次迭代：**
  \[
  x_3 = g(0.1906) \approx 0.1906^3 - 0.1906^2 - 4(0.1906) + 5 \approx 4.208.
  \]
三次迭代结果为：
\[
x_1 \approx \boxed{1.672}, \quad x_2 \approx \boxed{0.1906}, \quad x_3 \approx \boxed{4.208}.
\]
**比较与结论：**  
迭代结果未趋向 \( x = 1 \)，反而发散，验证了 (2) 中 \( x = 1 \) 处不收敛的结论。

[迭代法的基本思想](迭代法的基本思想.md)

# 3.7
$n=4$
$\sum x_i=6.96$
$\sum x_i^2=12.7274$
$\sum y_i=70.376$
$\sum y_i x_i=126.06601$

$4a_0+6.96a_1=70.376$
$6.96a_0+12.7274a_1=126.06601$

---

$a_0=7.4085 \space a_1=5.8538$

**∴** $y=7.4085+5.8538x$

# 3.8
为了求解给定的三对角线性方程组，采用追赶法（Crout分解）。方程组如下：

\[
\begin{cases}
2x_1 - x_2 = 6 \\
-x_1 + 3x_2 - 2x_3 = 1 \\
-2x_2 + 4x_3 - 3x_4 = -2 \\
-3x_3 + 5x_4 = 1
\end{cases}
\]

系数矩阵 \(A\) 和右端向量 \(b\) 为：
\[
A = \begin{bmatrix}
2 & -1 & 0 & 0 \\
-1 & 3 & -2 & 0 \\
0 & -2 & 4 & -3 \\
0 & 0 & -3 & 5
\end{bmatrix}, \quad
b = \begin{bmatrix}
6 \\
1 \\
-2 \\
1
\end{bmatrix}
\]

追赶法（Crout分解）将 \(A\) 分解为下三角矩阵 \(L\) 和单位上三角矩阵 \(U\)，即 \(A = LU\)，其中：
\[
L = \begin{bmatrix}
l_1 & 0 & 0 & 0 \\
m_2 & l_2 & 0 & 0 \\
0 & m_3 & l_3 & 0 \\
0 & 0 & m_4 & l_4
\end{bmatrix}, \quad
U = \begin{bmatrix}
1 & u_1 & 0 & 0 \\
0 & 1 & u_2 & 0 \\
0 & 0 & 1 & u_3 \\
0 & 0 & 0 & 1
\end{bmatrix}
\]

### 步骤1: 进行Crout分解
通过公式计算 \(L\) 和 \(U\) 的元素：
- \(l_1 = a_{11} = 2\)
- \(u_1 = a_{12} / l_1 = (-1) / 2 = -0.5\)
- \(m_2 = a_{21} = -1\)
- \(l_2 = a_{22} - m_2 u_1 = 3 - (-1) \times (-0.5) = 3 - 0.5 = 2.5\)
- \(u_2 = a_{23} / l_2 = (-2) / 2.5 = -0.8\)
- \(m_3 = a_{32} = -2\)
- \(l_3 = a_{33} - m_3 u_2 = 4 - (-2) \times (-0.8) = 4 - 1.6 = 2.4\)
- \(u_3 = a_{34} / l_3 = (-3) / 2.4 = -1.25\)
- \(m_4 = a_{43} = -3\)
- \(l_4 = a_{44} - m_4 u_3 = 5 - (-3) \times (-1.25) = 5 - 3.75 = 1.25\)

因此：
\[
L = \begin{bmatrix}
2 & 0 & 0 & 0 \\
-1 & 2.5 & 0 & 0 \\
0 & -2 & 2.4 & 0 \\
0 & 0 & -3 & 1.25
\end{bmatrix}, \quad
U = \begin{bmatrix}
1 & -0.5 & 0 & 0 \\
0 & 1 & -0.8 & 0 \\
0 & 0 & 1 & -1.25 \\
0 & 0 & 0 & 1
\end{bmatrix}
\]

### 步骤2: 解 \(Ly = b\)（前向代入）
解方程组 \(Ly = b\)：

\[
\begin{bmatrix}
2 & 0 & 0 & 0 \\
-1 & 2.5 & 0 & 0 \\
0 & -2 & 2.4 & 0 \\
0 & 0 & -3 & 1.25
\end{bmatrix}
\begin{bmatrix}
y_1 \\
y_2 \\
y_3 \\
y_4
\end{bmatrix}=\begin{bmatrix}
6 \\
1 \\
-2 \\
1
\end{bmatrix}
\]

- 方程1: \(2y_1 = 6\) → \(y_1 = 6 / 2 = 3\)
- 方程2: \(-y_1 + 2.5y_2 = 1\) → \(-3 + 2.5y_2 = 1\) → \(2.5y_2 = 4\) → \(y_2 = 4 / 2.5 = 1.6\)
- 方程3: \(-2y_2 + 2.4y_3 = -2\) → \(-2 \times 1.6 + 2.4y_3 = -2\) → \(-3.2 + 2.4y_3 = -2\) → \(2.4y_3 = 1.2\) → \(y_3 = 1.2 / 2.4 = 0.5\)
- 方程4: \(-3y_3 + 1.25y_4 = 1\) → \(-3 \times 0.5 + 1.25y_4 = 1\) → \(-1.5 + 1.25y_4 = 1\) → \(1.25y_4 = 2.5\) → \(y_4 = 2.5 / 1.25 = 2\)

所以：
\[
y = \begin{bmatrix}
3 \\
1.6 \\
0.5 \\
2
\end{bmatrix}
\]

### 步骤3: 解 \(Ux = y\)（后向代入）
解方程组 \(Ux = y\)：
\[
\begin{bmatrix}
1 & -0.5 & 0 & 0 \\
0 & 1 & -0.8 & 0 \\
0 & 0 & 1 & -1.25 \\
0 & 0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2 \\
x_3 \\
x_4
\end{bmatrix}=\begin{bmatrix}
3 \\
1.6 \\
0.5 \\
2
\end{bmatrix}
\]

- 方程4: \(x_4 = 2\)
- 方程3: \(x_3 - 1.25x_4 = 0.5\) → \(x_3 - 1.25 \times 2 = 0.5\) → \(x_3 - 2.5 = 0.5\) → \(x_3 = 3\)
- 方程2: \(x_2 - 0.8x_3 = 1.6\) → \(x_2 - 0.8 \times 3 = 1.6\) → \(x_2 - 2.4 = 1.6\) → \(x_2 = 4\)
- 方程1: \(x_1 - 0.5x_2 = 3\) → \(x_1 - 0.5 \times 4 = 3\) → \(x_1 - 2 = 3\) → \(x_1 = 5\)

### 最终解
因此，方程组的解为：
\[
x_1 = 5, \quad x_2 = 4, \quad x_3 = 3, \quad x_4 = 2
\]

### 验证
代入原方程组验证：
- 第一方程: \(2 \times 5 - 4 = 10 - 4 = 6\)
- 第二方程: \(-5 + 3 \times 4 - 2 \times 3 = -5 + 12 - 6 = 1\)
- 第三方程: \(-2 \times 4 + 4 \times 3 - 3 \times 2 = -8 + 12 - 6 = -2\)
- 第四方程: \(-3 \times 3 + 5 \times 2 = -9 + 10 = 1\)

所有方程均满足，解正确。

## 追赶法递推公式

追赶法（Crout分解）有明确的递推公式用于计算 \( L \) 和 \( U \) 的元素。对于三对角矩阵：
\[
A = \begin{pmatrix}
b_1 & c_1 & 0 & \cdots & 0 \\
a_2 & b_2 & c_2 & \ddots & \vdots \\
0 & a_3 & b_3 & \ddots & 0 \\
\vdots & \ddots & \ddots & \ddots & c_{n-1} \\
0 & \cdots & 0 & a_n & b_n
\end{pmatrix}
\]
其Crout分解 \( A = LU \) 的元素计算公式如下：

### **L 和 U 的元素计算公式**
1. **首行元素**：
   \[
   \begin{cases}
   l_1 = b_1 \\
   u_1 = \dfrac{c_1}{l_1}
   \end{cases}
   \]

2. **中间行元素**（\( i = 2, 3, \dots, n-1 \))：
   \[
   \begin{cases}
   l_i = b_i - a_i \cdot u_{i-1} \\
   u_i = \dfrac{c_i}{l_i}
   \end{cases}
   \]

3. **末行元素**：
   \[
   l_n = b_n - a_n \cdot u_{n-1}
   \]

---

### **公式说明**
- **\( L \) 的元素**：
  - 对角线元素：\( l_i \)（递推计算）
  - 次对角线元素：直接取自 \( A \) 的次对角线元素 \( a_i \)（无需计算）

- **\( U \) 的元素**：
  - 主对角线元素：固定为 \( 1 \)
  - 上对角线元素：\( u_i \)（递推计算）

---

### **求解过程的公式**
分解后，求解 \( A\mathbf{x} = \mathbf{b} \) 的两步递推公式：

1. **前向代入**（解 \( L\mathbf{y} = \mathbf{b} \))：
   \[
   \begin{cases}
   y_1 = \dfrac{b_1}{l_1} \\
   y_i = \dfrac{b_i - a_i \cdot y_{i-1}}{l_i}, \quad i = 2, 3, \dots, n
   \end{cases}
   \]

2. **后向代入**（解 \( U\mathbf{x} = \mathbf{y} \))：
   \[
   \begin{cases}
   x_n = y_n \\
   x_i = y_i - u_i \cdot x_{i+1}, \quad i = n-1, n-2, \dots, 1
   \end{cases}
   \]

---

### **关键点**
- **计算顺序**：  
  严格按 \( l_1 \to u_1 \to l_2 \to u_2 \to \cdots \to l_n \) 的顺序递推计算。

- **稳定性条件**：  
  当 \( |b_i| > |a_i| + |c_i| \)（严格对角占优）时，公式稳定且 \( l_i \neq 0 \).

- **计算量**：  
  仅需 \( 5n-4 \) 次乘除法和 \( 3n-3 \) 次加减法（\( O(n) \) 复杂度），远低于普通LU分解的 \( O(n^3) \).

这些公式是追赶法的核心，高效且易于编程实现，广泛应用于三对角方程组的求解。

# 3.9

这俩题一模一样

[飞吧！](#34)
# 3.10

(1) **证明f(x)在[1,2]上有且只有一个根：**
- **存在性**：计算端点值，f(1) = -1 < 0，f(2) = 45 > 0。由中间值定理，f(x)在(1,2)内至少有一个根。
- **唯一性**：求导f’(x) = 5x⁴ + 4x³。当x ∈ [1,2]时，f’(x) > 0，故f(x)严格递增，故仅有一个根。

(2) **二分法所需最少步数：**
误差要求|cₙ - α| ≤ 10⁻⁶。初始区间长度L = 1，每次迭代后区间长度减半。误差上界为L/(2ⁿ⁺¹) ≤ 10⁻⁶，解得n ≥ log₂(10⁶) - 1 ≈ 19.93，故至少需要**20步**。


(3) **牛顿迭代法（x₀=1，迭代两步）：**

  \[
  x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}
  \]  

- **x₁**：x₁ = 1 - (-1)/(5·1⁴ + 4·1³) = 1 + 1/9 ≈ 1.111111
- **x₂**：计算f(1.111111) ≈ 0.217667，f’(1.111111) ≈ 13.10776，故x₂ ≈ 1.111111 - 0.217667/13.10776 ≈ **1.094500**

(4) **弦截法（x₀=1，x₁=2，迭代两步）：**

  \[
  x_{n+1} = x_n - f(x_n) \cdot \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}
  \]  

- **x₂**：x₂ = 2 - 45·(2-1)/(45 - (-1)) = 2 - 45/46 ≈ 1.021739
- **x₃**：计算f(1.021739) ≈ -0.7969，故x₃ ≈ 1.021739 - (-0.7969)·(1.021739-2)/(-0.7969-45) ≈ **1.038779**
---

# 3.11

$f[x_i,x_j]=\frac{f[x_i]-f[x_j]}{x_i-x_j}$

| $x_i$ | $f(x_i)$ |  1阶  |  2阶  |  3阶  |
| :---: | :------: | :---: | :---: | :---: |
|   1   |    0     |       |       |       |
|   2   |    -5    |  -5   |       |       |
|   3   |    -6    |  -1   |   2   |       |
|   4   |    3     |   9   |   5   |   1   |

$N_3(x)=0-5(x-1)+2(x-2)(x-1)+(x-3)(x-2)(x-1)$

$N_3(1.5)=-2.625$


# 3.13
### 矩阵A的Doolittle分解与方程组求解
#### **步骤1：Doolittle分解矩阵A为L和U**
给定矩阵：
$$
A = \begin{pmatrix}
1 & 1 & 2 \\
3 & 2 & 1 \\
2 & 2 & -1
\end{pmatrix}, \quad
b = \begin{pmatrix}
7 \\ 13 \\ 9
\end{pmatrix}
$$
目标分解为：
$$
L = \begin{pmatrix}
1 & 0 & 0 \\
l_{21} & 1 & 0 \\
l_{31} & l_{32} & 1
\end{pmatrix}, \quad
U = \begin{pmatrix}
u_{11} & u_{12} & u_{13} \\
0 & u_{22} & u_{23} \\
0 & 0 & u_{33}
\end{pmatrix}
$$
**分解过程：**
1. **计算U的第一行：**
   - 直接取自A的第一行：
   $$
   u_{11} = 1, \quad u_{12} = 1, \quad u_{13} = 2
   $$
2. **计算L的第一列：**
   - 公式：\( l_{i1} = \frac{a_{i1}}{u_{11}} \)
   $$
   l_{21} = \frac{3}{1} = 3, \quad l_{31} = \frac{2}{1} = 2
   $$
3. **计算U的第二行：**
   - 公式：\( u_{2j} = a_{2j} - l_{21}u_{1j} \)
   $$
   u_{22} = 2 - 3 \cdot 1 = -1, \quad u_{23} = 1 - 3 \cdot 2 = -5
   $$
4. **计算L的第二列：**
   - 公式：\( l_{32} = \frac{a_{32} - l_{31}u_{12}}{u_{22}} \)
   $$
   l_{32} = \frac{2 - 2 \cdot 1}{-1} = 0
   $$
5. **计算U的第三行：**
   - 公式：\( u_{33} = a_{33} - (l_{31}u_{13} + l_{32}u_{23}) \)
   $$
   u_{33} = -1 - (2 \cdot 2 + 0 \cdot (-5)) = -5
   $$
**分解结果：**
$$
L = \begin{pmatrix}
1 & 0 & 0 \\
3 & 1 & 0 \\
2 & 0 & 1
\end{pmatrix}, \quad
U = \begin{pmatrix}
1 & 1 & 2 \\
0 & -1 & -5 \\
0 & 0 & -5
\end{pmatrix}
$$

---
#### **步骤2：前代求解Ly = b**

方程组：
$$
\begin{cases}
y_1 = 7 \\
3y_1 + y_2 = 13 \\
2y_1 + 0 \cdot y_2 + y_3 = 9
\end{cases}
$$
解得：
$$
y_1 = 7, \quad y_2 = 13 - 3 \cdot 7 = -8, \quad y_3 = 9 - 2 \cdot 7 = -5
$$
即：
$$
y = \begin{pmatrix}
7 \\ -8 \\ -5
\end{pmatrix}
$$

---
#### **步骤3：回代求解Ux = y**
方程组：
$$
\begin{cases}
x_1 + x_2 + 2x_3 = 7 \\
-x_2 - 5x_3 = -8 \\
-5x_3 = -5
\end{cases}
$$
解得：
$$
x_3 = 1, \quad x_2 = 3, \quad x_1 = 2
$$

---
#### **最终解**
$$
\boxed{x = \begin{pmatrix}
2 \\ 3 \\ 1
\end{pmatrix}}
$$

---
### **关键公式总结**
1. **Doolittle分解规则：**
   - \( u_{ij} = a_{ij} - \sum_{k=1}^{i-1} l_{ik}u_{kj} \)（计算U的第i行）
   - \( l_{ij} = \frac{a_{ij} - \sum_{k=1}^{j-1} l_{ik}u_{kj}}{u_{jj}} \)（计算L的第i列）
2. **前代求解Ly = b：**
   - 从上到下逐行代入已知值。
3. **回代求解Ux = y：**
   - 从下到上逐行代入已知值。
通过以上步骤，完成矩阵分解并求解方程组。
